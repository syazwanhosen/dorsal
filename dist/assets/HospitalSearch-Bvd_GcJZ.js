import{j as e}from"./radix-hoWLJplZ.js";import{P as k,H,h as E,S as M}from"./hospital-D9YWEQkI.js";import{u as _,h as g,s as C,i as P,j as R,k as F,l as T,m as j,n as y,o as L,p as $,q as z,N as A,H as B,F as D,S as I}from"./index-Bl-JI4NS.js";import{a as p}from"./react-DyejIWKk.js";import{M as O,T as Z,a as Q,l as q,P as J,u as w}from"./maps-Cu4X6U0v.js";import"./charts-ZmEBPBrd.js";import"./ui-lp5hxHkm.js";import"./redux-CrWtP8Qi.js";const U=({serviceName:s,serviceDescription:l,cptCode:a,hasSearchResult:o,prices:i,hospitalNames:h})=>e.jsx("section",{id:"ProcedureCard",className:"mt-2 container px-4 sm:px-6 md:px-4 lg:px-8 xl:px-16",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-start justify-between space-y-4 lg:space-y-0 lg:space-x-6",children:[e.jsxs("div",{className:"w-full lg:w-[60%]",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:s}),a&&e.jsxs("span",{className:"bg-purple text-white text-xs font-semibold px-2 py-1 rounded w-fit sm:w-auto",children:["CPT Code ",a]})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-2",children:l})]}),o&&e.jsx("div",{className:"w-full lg:w-[40%] rounded-lg border",children:e.jsx(k,{prices:i,hospitalNames:h})})]})}),W=()=>{const s=_(),{loading:l}=g(r=>r.hospitalServiceSearch),[a,o]=p.useState({search:"",location:"",min_price:"",max_price:""}),i=(r,n)=>{o(x=>({...x,[r]:n}))},h=()=>{const{search:r,location:n,min_price:x,max_price:u}=a;if(!r){alert("Please enter a service name.");return}if(!n){alert("Please enter a location.");return}const f={service_name:r,location:n||void 0,min_price:x?Number(x):void 0,max_price:u?Number(u):void 0};s(C(!0)),P(f).then(d=>{s(R({code:d.code,service_description:d.service_description,hospital_count:d.hospital_count,hospital_names:d.hospital_names||[],prices:d.prices||[],distances:d.distances||[],generic_service_name:d.generic_service_name||a.search,location:a.location||"",min_price:a.min_price?Number(a.min_price):void 0,max_price:a.max_price?Number(a.max_price):void 0}))}).catch(d=>{console.error("❌ Error performing search:",d)}).finally(()=>s(C(!1)))};return e.jsx(e.Fragment,{children:e.jsx("section",{id:"SearchHospital",className:"container py-6 px-4 sm:px-6 md:px-4 lg:px-8 xl:px-16",children:e.jsxs("div",{className:"flex flex-wrap lg:flex-nowrap items-center border border-purple-400 rounded overflow-hidden bg-white text-sm",children:[e.jsx("div",{className:"flex flex-wrap flex-grow",children:[{key:"search",label:"Search",placeholder:"Enter service name"},{key:"location",label:"Location",placeholder:"Enter location"},{key:"min_price",label:"Min Price",placeholder:"Enter min price"},{key:"max_price",label:"Max Price",placeholder:"Enter max price"}].map(r=>e.jsxs("div",{className:"relative w-full sm:w-1/2 md:w-1/3 lg:w-1/4 lg:border-r md:border-r p-2",children:[e.jsx("label",{className:"block text-xs text-black font-semibold",children:r.label}),e.jsx("input",{type:"text",className:"w-full focus:outline-none text-sm bg-white",value:a[r.key],onChange:n=>i(r.key,n.target.value),placeholder:r.placeholder})]},r.key))}),e.jsx("button",{onClick:h,className:"bg-purple hover:bg-purple-700 text-white px-10 lg:py-4 py-2 sm:px-10 text-sm font-semibold border lg:w-auto w-full",children:l?"Searching...":"SEARCH"})]})})})},X="data:image/svg+xml,%3csvg%20width='12'%20height='16'%20viewBox='0%200%2012%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2015.5C5.825%2015.5%205.675%2015.45%205.55%2015.35C5.425%2015.25%205.33125%2015.1187%205.26875%2014.9562C5.03125%2014.2562%204.73125%2013.6%204.36875%2012.9875C4.01875%2012.375%203.525%2011.6562%202.8875%2010.8312C2.25%2010.0062%201.73125%209.21875%201.33125%208.46875C0.94375%207.71875%200.75%206.8125%200.75%205.75C0.75%204.2875%201.25625%203.05%202.26875%202.0375C3.29375%201.0125%204.5375%200.5%206%200.5C7.4625%200.5%208.7%201.0125%209.7125%202.0375C10.7375%203.05%2011.25%204.2875%2011.25%205.75C11.25%206.8875%2011.0312%207.8375%2010.5938%208.6C10.1688%209.35%209.675%2010.0938%209.1125%2010.8312C8.4375%2011.7312%207.925%2012.4812%207.575%2013.0812C7.2375%2013.6687%206.95625%2014.2937%206.73125%2014.9562C6.66875%2015.1312%206.56875%2015.2688%206.43125%2015.3688C6.30625%2015.4563%206.1625%2015.5%206%2015.5ZM6%207.625C6.525%207.625%206.96875%207.44375%207.33125%207.08125C7.69375%206.71875%207.875%206.275%207.875%205.75C7.875%205.225%207.69375%204.78125%207.33125%204.41875C6.96875%204.05625%206.525%203.875%206%203.875C5.475%203.875%205.03125%204.05625%204.66875%204.41875C4.30625%204.78125%204.125%205.225%204.125%205.75C4.125%206.275%204.30625%206.71875%204.66875%207.08125C5.03125%207.44375%205.475%207.625%206%207.625Z'%20fill='%23CE3C29'/%3e%3c/svg%3e",Y="zt7wt1ZXSBmlye8q8IQ6HuOv6p4idsbIbLl3Qi2ns2X4ZcbQbarIZpGE6YAkfi6L",G=new q.Icon({iconUrl:E,iconSize:[30,30],iconAnchor:[15,30],popupAnchor:[0,-30]}),K=({sidebarOpen:s})=>{const l=w();return p.useEffect(()=>{const a=setTimeout(()=>{l.invalidateSize({animate:!0})},500);return()=>clearTimeout(a)},[s,l]),null},V=({location:s})=>{const l=w();return p.useEffect(()=>{s&&s[0]!==null&&s[1]!==null&&l.flyTo(s,15,{duration:1.5})},[s,l]),null},ee=({hospitals:s})=>{const l=w();return p.useEffect(()=>{if(s.length===0)return;const a=s.map(o=>[o.latitude,o.longitude]);l.fitBounds(a,{padding:[50,50]})},[s,l]),null},se=()=>{const s=_(),{hospitals:l,selectedHospitals:a,sortOption:o,sidebarOpen:i,selectedLocation:h}=g(t=>t.hospitalServiceSearch),r=g(t=>t.hospitalServiceSearch.serviceSearchResults),n=p.useMemo(()=>[...l].sort((t,c)=>{if(o==="lowestPrice")return t.price-c.price;if(o==="shortestDistance"){const m=parseFloat(t.distance),v=parseFloat(c.distance);return m-v}return 0}),[o,l]),x=p.useMemo(()=>n.length>0?[n[0].latitude,n[0].longitude]:[40.8106,-73.955],[n]);p.useEffect(()=>{var t;!r||!((t=r.hospital_names)!=null&&t.length)||F(r.hospital_names).then(c=>{const m=c.map((v,b)=>{var S,N;return{...v,name:r.hospital_names[b],price:((S=r.prices)==null?void 0:S[b])||0,distance:((N=r.distances)==null?void 0:N[b])||0,title:r.generic_service_name||"Unknown Service",description:r.service_description||"No description available",code:r.code||"N/A",location:r.location||"Not provided",min_price:r.min_price||0,max_price:r.max_price||0}});s(T(m))}).catch(c=>console.error("Error fetching hospital metadata:",c))},[r,s]);const u=t=>{a.length<2&&!a.includes(t)?s(j([...a,t])):alert("You can only compare up to 2 hospitals at a time.")},f=t=>{s(j(a.filter(c=>c.name!==t)))};if(p.useEffect(()=>{s(j([]))},[r,s]),!r)return null;const d=t=>{s(z({...t,selectedState:r.selectedState,selectedServiceCategory:r.selectedServiceCategory,selectedSubcategory:r.selectedSubcategory,selectedCptCode:r.selectedCptCode,selectedServiceName:r.selectedServiceName})),setTimeout(()=>{window.open("/hospital_service_details","_blank")},100)};return e.jsxs("section",{className:"container px-4 sm:px-6 md:px-4 lg:px-8 xl:px-16 mb-4",children:[e.jsxs("div",{className:"relative lg:mt-12 mt-4 flex flex-col lg:flex-row rounded-xl overflow-hidden border border-purple-200 shadow-md h-[90vh] w-full max-w-screen-2xl mx-auto",children:[e.jsxs("button",{onClick:()=>s(y(!i)),className:`lg:hidden z-20 h-12 w-full flex items-center justify-center bg-white shadow-sm transition-all duration-300 ${i?"border-b border-gray-200":""}`,children:[e.jsx("span",{className:"text-gray-600 mr-2",children:i?"Hide Results":"Show Results"}),e.jsx("svg",{className:`w-5 h-5 text-gray-600 transition-transform duration-300 ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15 19l-7-7 7-7"})})]}),e.jsx("button",{onClick:()=>s(y(!i)),className:`absolute z-20 top-4 h-12 w-10 items-center justify-center bg-white shadow-sm transition-all duration-300 hidden lg:flex ${i?"left-[calc(31%-16px)]":"left-0"} rounded-tr-lg rounded-br-lg hidden lg:block`,children:e.jsx("svg",{className:`w-5 h-5 text-gray-600 transition-transform duration-300 ${i?"":"rotate-180"}`,fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:`${i?`lg:w-[30%] ${l.length<=1?"h-auto":"h-[40vh]"} lg:h-full`:"h-0 lg:h-full lg:w-0"} 
    transition-all duration-500 ease-in-out overflow-auto bg-white`,children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[l.length," Results"]}),e.jsxs("select",{value:o,onChange:t=>s(L(t.target.value)),className:"border border-gray-300 lg:px-8 px-6 py-1 rounded-md text-sm",children:[e.jsx("option",{value:"lowestPrice",children:"Lowest Price"}),e.jsx("option",{value:"shortestDistance",children:"Shortest Distance"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:l.length===0?e.jsx("div",{className:"px-4 pb-4 text-center text-gray-500",children:"No hospitals found matching your criteria"}):e.jsx("div",{className:"px-4 pb-4 space-y-4",children:n.map((t,c)=>e.jsxs("div",{onClick:()=>{t.latitude&&t.longitude&&s($([t.latitude,t.longitude]))},className:"border-b border-gray-200 pb-4 cursor-pointer hover:bg-purple-50 p-2 transition last:border-b-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:e.jsx("button",{onClick:m=>{m.stopPropagation(),d(t)},className:"text-black hover:underline hover:text-purple-700 text-left",children:t.name})}),e.jsx("button",{onClick:m=>{m.stopPropagation(),u(t)},className:"ml-2 px-3 py-1 text-xs font-medium text-[#8770BC] bg-[#EEEBF4] rounded hover:bg-[#e0d9f0] transition",children:"Compare"})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[e.jsxs("span",{children:["⭐ ",t.rating||0]}),e.jsxs("span",{className:"flex items-center mx-2",children:[e.jsx("img",{src:X,alt:"Location Icon",className:"w-4 h-4"}),t.distance?`${t.distance.toFixed(2)} mi`:"N/A"]})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:t.address}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded ${t.negotiation_status==="Fixed"?"bg-[#6CA724] text-white":"bg-[#CE3C29] text-white"}`,children:[t.negotiation_status," Price"]}),e.jsxs("span",{className:"text-[#8770BC] text-xl font-bold",children:["$",t.price]})]})]},c))})})]}),e.jsx("div",{className:`${i?"lg:w-[70%] h-[60vh] lg:h-full":"h-[100vh] lg:h-full"} transition-all duration-500 ease-in-out w-full`,children:e.jsxs(O,{center:x,zoom:12,zoomControl:!1,className:"h-full w-full z-0",children:[e.jsx(K,{sidebarOpen:i}),e.jsx(V,{location:h}),e.jsx(ee,{hospitals:n}),e.jsx(Z,{url:`https://tile.jawg.io/jawg-sunny/{z}/{x}/{y}{r}.png?access-token=${Y}`,attribution:'<a href="https://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">© <b>Jawg</b>Maps</a> © <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),n.map((t,c)=>e.jsx(Q,{position:[t.latitude,t.longitude],icon:G,children:e.jsx(J,{children:t.name})},c))]})})]}),a.length>0&&e.jsx(H,{selectedHospitals:a,onRemoveHospital:f})]})};function de(){const{serviceSearchResults:s}=g(l=>l.hospitalServiceSearch);return console.log("Redux Service Search Results:",s),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"min-h-screen flex flex-col hospital_page",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx(A,{}),e.jsx(B,{title:"Hospitals Service Search"}),e.jsx(W,{}),s?e.jsxs(e.Fragment,{children:[e.jsx(U,{serviceName:s.generic_service_name||"",serviceDescription:s.service_description||"",cptCode:s.code,hasSearchResult:s.hospital_count>0,prices:s.prices,hospitalNames:s.hospital_names}),e.jsx(se,{})]}):e.jsx(M,{})]}),e.jsx(D,{}),e.jsx(I,{})]})})}export{de as default};
