import{j as e}from"./radix-hoWLJplZ.js";import{u as N,w as j,x as b,h as y}from"./index-Bl-JI4NS.js";import{u as v,a as k}from"./react-DyejIWKk.js";import{aa as u}from"./ui-lp5hxHkm.js";import{a as C}from"./index-xsH4HHeE.js";import{W as P}from"./WithLoading-B9eRASBv.js";import"./redux-CrWtP8Qi.js";import"./maps-Cu4X6U0v.js";import"./Spinner-D0Y5dMqM.js";const A=async p=>{var a,r;try{return(await C.post("http://123.200.16.106:3838/audit/audit",p)).data}catch(l){throw new Error(((r=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:r.error)||l.message||"Upload failed")}};function S({hospitalName:p,billingData:a,subtotal:r,taxPercentage:l,payableTax:c,totalAmount:x}){const d=N(),m=v(),h=a.some(s=>s.code),t=a.some(s=>s.description),i=a.some(s=>s.quantity),n=a.some(s=>s.unit_cost),o=a.some(s=>s.price),f=!!(l||c),w=async()=>{d(j(!0));try{const s=await A({hospital_name:p,billing_information:a});d(j(!1)),d(b(s)),u.success(s==null?void 0:s.message),setTimeout(()=>{m("/account/audit-findings")},500)}catch(s){u.error("Audit failed",{description:s.message||"An unexpected error occurred."}),alert((s==null?void 0:s.message)||"An unexpected error occurred while running the audit.")}finally{d(j(!1))}};return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md lg:mt-6 mt-4 lg:mb-8 mb-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between lg:items-center mb-4 gap-2",children:[e.jsx("p",{className:"text-lg font-semibold text-black",children:"Bill Statement"}),e.jsx("button",{className:"hidden lg:flex bg-[#8771BC] text-white px-6 py-2 rounded-md items-center shadow-md hover:shadow-lg transition-shadow md:w-auto justify-center",onClick:w,children:"Run Audit"})]}),e.jsx("div",{className:"w-full overflow-x-auto hidden lg:block",children:e.jsxs("table",{className:"table-auto w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"pb-4",children:[h&&e.jsx("th",{className:"p-3 font-semibold text-left lg:py-4 w-[140px] whitespace-nowrap",children:"Service Code"}),t&&e.jsx("th",{className:"p-3 font-semibold text-left lg:py-4",children:"Description"}),i&&e.jsx("th",{className:"p-3 font-semibold text-center lg:py-4 whitespace-nowrap",children:"Quantity"}),n&&e.jsx("th",{className:"p-3 font-semibold text-right lg:py-4 whitespace-nowrap",children:"Unit Cost (USD)"}),o&&e.jsx("th",{className:"p-3 font-semibold text-right lg:py-4 w-[160px] whitespace-nowrap",children:"Price (USD)"})]})}),e.jsx("tbody",{children:a.map((s,g)=>e.jsxs("tr",{className:"text-[#89868D] border-t border-[#89868d4a]",children:[h&&e.jsx("td",{className:"p-3 lg:py-4",children:s.code}),t&&e.jsx("td",{className:"p-3 lg:py-4",children:s.description}),i&&e.jsx("td",{className:"p-3 text-center lg:py-4",children:s.quantity??"-"}),n&&e.jsx("td",{className:"p-3 text-right lg:py-4",children:s.unit_cost??"-"}),o&&e.jsx("td",{className:"p-3 text-right lg:py-4",children:s.price})]},g))})]})}),e.jsxs("div",{className:"hidden lg:block mt-6 w-full max-w-md ml-auto space-y-2 text-right text-gray-800 font-medium",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-4",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"text-right",children:(r==null?void 0:r.toFixed(2))??"0.00"})]}),f&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-4",children:[e.jsxs("span",{children:["Tax (",l,"%)"]}),e.jsx("span",{children:(c==null?void 0:c.toFixed(2))??"0.00"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 font-bold text-[#8770BC]",children:[e.jsx("span",{children:"Total Payable (USD)"}),e.jsx("span",{children:(x==null?void 0:x.toFixed(2))??"0.00"})]})]}),e.jsxs("div",{className:"block lg:hidden mt-6",children:[a.map((s,g)=>e.jsxs("div",{className:"p-4 border-b border-gray-300 rounded-lg shadow-md bg-white mb-4",children:[t&&e.jsx("p",{className:"font-semibold text-gray-800",children:s.description}),h&&e.jsxs("p",{className:"text-gray-600 text-sm",children:[e.jsx("span",{className:"whitespace-nowrap",children:"Service Code:"})," ",s.code]}),i&&e.jsxs("p",{className:"text-gray-600 text-sm",children:[e.jsx("span",{className:"whitespace-nowrap",children:"Quantity:"})," ",s.quantity??"-"]}),n&&e.jsxs("p",{className:"text-gray-600 text-sm",children:[e.jsx("span",{className:"whitespace-nowrap",children:"Unit Cost:"}),s.unit_cost??"-"]}),o&&e.jsxs("p",{className:"text-gray-600 text-sm",children:[e.jsx("span",{className:"whitespace-nowrap",children:"Price:"})," ",s.price]})]},g)),e.jsxs("div",{className:"lg:hidden p-4 font-bold text-gray-800 text-right bg-gray-100 rounded-lg shadow-md space-y-1",children:[e.jsxs("p",{children:["Subtotal: ",(r==null?void 0:r.toFixed(2))??"0.00"]}),f&&e.jsx(e.Fragment,{children:e.jsxs("p",{children:["Tax (",l,")%: ",(c==null?void 0:c.toFixed(2))??"0.00"]})}),e.jsxs("p",{className:"text-[#8770BC]",children:["Total Payable (USD): ",(x==null?void 0:x.toFixed(2))??"0.00"]})]}),e.jsx("button",{className:"bg-[#8771BC] text-white px-6 py-2 rounded-md flex items-center shadow-md hover:shadow-lg transition-shadow w-full justify-center mt-4",onClick:w,children:"Run Audit"})]})]})}function F(){const a=y(i=>i.audit.auditRecords).at(-1);if(!a)return e.jsx("p",{className:"p-6 text-gray-600",children:"No audit data available."});const{invoice_number:r,date:l,hospital_name:c,state:x,patient_information:d,doctor_information:m,billing_data:h,total_price:t}=a;return k.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),e.jsxs(P,{sliceKey:"audit",children:[e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md lg:mt-6 mt-4 lg:mb-8 mb-4 overflow-hidden",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Transaction Details"}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"lg:flex flex-wrap items-center",children:[e.jsx("p",{className:"text-gray-600 lg:pb-4 w-32 min-w-[6rem]",children:"Invoice No:"}),e.jsx("p",{className:"text-gray-800 pb-4 flex-1",children:r})]}),e.jsxs("div",{className:"lg:flex flex-wrap items-center",children:[e.jsx("p",{className:"text-gray-600 lg:pb-4 w-32 min-w-[6rem]",children:"Date:"}),e.jsx("p",{className:"text-gray-800 pb-4 flex-1",children:l})]}),e.jsxs("div",{className:"lg:flex flex-wrap items-center",children:[e.jsx("p",{className:"text-gray-600 w-32 min-w-[6rem]",children:"Hospital:"}),e.jsxs("p",{className:"text-gray-800 flex-1",children:[c,", ",x]})]})]}),e.jsxs("div",{className:"mb-8 flex flex-col lg:flex-row lg:space-x-4 gap-6 max-w-full mx-auto items-stretch",children:[e.jsxs("div",{className:"w-full lg:w-1/2 flex flex-col",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-3 lg:pb-4",children:"Patient Information"}),e.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-center gap-4 p-4 lg:py-6 border border-gray-300 rounded-md flex-grow h-full",children:[e.jsx("img",{src:"/src/assets/user.png",alt:"User Profile Image",className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full object-cover border border-gray-200"}),e.jsxs("div",{className:"space-y-1 text-center sm:text-left",children:[e.jsx("p",{className:"text-gray-800 font-medium pb-2 break-words",children:d.name}),(()=>{const i=d.details.match(/^(.*?)Phone:/),n=d.details.match(/Phone:\s*([^\s]+.*?)(Email:|$)/),o=d.details.match(/Email:\s*(.*)$/);return e.jsxs(e.Fragment,{children:[i&&e.jsx("p",{className:"text-[#3A3541] pb-2 break-words",children:i[1].trim()}),o&&e.jsx("p",{className:"text-[#3A3541] pb-2 break-words",children:o[1].trim()}),n&&e.jsx("p",{className:"text-[#3A3541] pb-2 break-words",children:n[1].trim()})]})})()]})]})]}),e.jsxs("div",{className:"w-full lg:w-1/2 flex flex-col",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-3 lg:pb-4",children:"Practitioner Information"}),e.jsxs("div",{className:"space-y-1 p-4 lg:py-6 border border-gray-300 rounded-md flex-grow h-full",children:[e.jsx("p",{className:"text-gray-800 font-medium pb-2 break-words",children:m.name}),(()=>{const i=m.details.match(/Specialty:\s*(.*?)(License|Phone|$)/),n=m.details.match(/License(?: No)?:\s*(.*?)(Phone|$)/),o=m.details.match(/Phone:\s*(.*)$/);return e.jsxs(e.Fragment,{children:[n&&e.jsxs("p",{className:"text-[#3A3541] pb-2 break-words flex",children:[e.jsx("span",{className:"lg:w-40",children:"Practitioner ID:"}),e.jsx("span",{children:n[1].trim()})]}),o&&e.jsxs("p",{className:"text-[#3A3541] pb-2 break-words flex",children:[e.jsx("span",{className:"lg:w-40",children:"Contact Info:"}),e.jsx("span",{children:o[1].trim()})]}),i&&e.jsxs("p",{className:"text-[#3A3541] pb-2 break-words flex",children:[e.jsx("span",{className:"lg:w-40",children:"Speciality:"}),e.jsx("span",{children:i[1].trim()})]})]})})()]})]})]})]}),e.jsx(S,{billingData:h,hospitalName:c,subtotal:t==null?void 0:t.subtotal,taxPercentage:t==null?void 0:t.tax_percentage,payableTax:t==null?void 0:t.payable_tax,totalAmount:t==null?void 0:t.total})]})}function L(){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container px-0",children:[e.jsx("h1",{className:"text-lg font-medium text-[#8770BC] ml-10",children:"Audit Bill"}),e.jsx(F,{})]})})}export{L as default};
